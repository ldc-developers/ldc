format_version: '8'
default_step_lib_source: https://github.com/bitrise-io/bitrise-steplib.git
project_type: ios

app:
  envs:
    - BITRISE_PROJECT_PATH: bitrise-test/bitrise-test.xcodeproj
    - BITRISE_SCHEME: bitrise-test
    - BITRISE_EXPORT_METHOD: development

workflows:
  primary:
    steps:
      - script@1.1.5:
          title: Debug Info AFter
          inputs:
          - content: |-
              #!/bin/bash
              set -ex

              echo $CI
              echo $PR
              echo $BITRISE_CERTIFICATE_URL
              echo $BITRISE_DEFAULT_CERTIFICATE_URL
              echo $BITRISE_PULL_REQUEST
              echo $BITRISE_GIT_MESSAGE
              echo $BITRISE_BUILD_URL
              echo $BITRISE_APP_URL
              echo $BITRISE_APP_SLUG

      - cache-pull@2.1.4: {}
      - certificate-and-profile-installer@1.10.3: {}

      - xcode-build-for-test@0.4.0:
          title: Build Xcode Project

      - virtual-device-testing-for-ios@0.9.10:
          title: Run Tests on Device
          inputs:
            - test_devices: iphonexr,13.2,en,portrait
            - download_test_results: true

      - deploy-to-bitrise-io@1.9.6: {}
      - cache-push@2.2.3: {}
